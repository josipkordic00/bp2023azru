<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insert classroom</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="navbar-brand mx-auto" style="margin-right: 325px !important">
        Insert classroom |
      </div>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav"></div>
      <a class="nav-link" href="login.html">Logout</a>
    </nav>
    <div class="container d-flex justify-content-center align-items-center">
      <form class="d-flex flex-column justify-content-between align-items-center m-1 w-50" method="POST">
        <input id="classroom_number" class="m-1 p-1 col-12" style="width: 100%; max-width: 600px" name="classroom_number" type="text" placeholder="Classroom number" />
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <select class="custom-select m-1 p-1 col-12" id="institution"></select>
      
        <input class="btn btn-primary" id="insertClassroom" type="submit" value="Save" style="color: white" />
      </form>
      
    </div>
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
  $(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "/insertClassroom/class",
        success: function (data) {
            console.log(data);
            function populateInstitutions() {
                const institutionSelect = $('#institution');
                institutionSelect.empty(); // Clear existing options
    
                // Create and append option elements for each institution
                data.forEach(institution => {
                    const option = $('<option>').val(institution.id).text(institution.institution_name);
                    institutionSelect.append(option);
                });
            }
            populateInstitutions();
        },
        error: function (error) {
            console.error("Nastala je greška:", error);
        },
    });
});


  $(document).on("click", "#insertClassroom", function () {
  // Disable the submit button to prevent multiple form submissions
  $("#insertClassroom").prop("disabled", true);

  var formData = {
    classroom_number: $("#classroom_number").val(),
    institution: $("#institution").val()
  };
  console.log(formData)
  
  $.ajax({
    type: "POST",
    url: "/insertClassroom",
    data: formData,
    beforeSend: function(xhr) {
      xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token() }}");
    },
    success: function (response) {
      console.log("Razred dodan!");
      window.location.href = "/admin"
    },
    error: function (error) {
      console.error("Nastala je greška:", error);
    },
  });
});



    </script>
  </body>
</html>
